#计算机网络
# TCP 可靠传输的实现原理

## 可靠的定义
- 传输的数据没有差错
- 传输的数据不会丢失

## 如何保证可靠
- 传输出错的数据进行重新传输
- 控制传输速度，让接收方来得及处理

# 超时重传协议

在发送数据后的规定时间内，如果没有收到接收方的确认消息，则视为未收到，重新传输数据。

**重新传输数据的时间T应该怎么设定？**
A -> B 发送数据     ---- t1
B 处理消息          ---- t2
B -> A  发送确认消息 ---- t3

可以取t1, t2, t3 的平均值，T需要大于这个平均值

# 停止等待协议
在网络传输当中，如果发送方等待接收方发送确认消息才进行下一次传输，会导致效率大大降低，且只有单方通信。TCP协议是全双工通信，因此在AB双方都有一个缓冲区。所有的消息会被存放在缓冲区中。
## 缓冲区工作原理
**A -> B 发送消息**
1. 只要缓冲区不满，A就会持续发送消息。
2. 每当B从缓冲区中取出消息，处理完毕，就会发送确认消息给A，同时处理下一条消息。
3. 当A收到了B的确认消息，就会从缓冲区移除对应的消息。
4. 如此循环，直到所有消息发送完毕。

**没有缓冲区的停止等待协议相当于缓冲区大小为1的情况**

# 连续ARQ协议（滑动窗口）
![[Pasted image 20230618145823.png]]
![[Pasted image 20230618145826.png]]

